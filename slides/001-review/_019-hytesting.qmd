---
name: hypothesis-testing
---

# Hypothesis testing {.inverse .note}

---

::: {.vertical-center}
In every stats class I have ever taken, I learned about [hypothesis testing]{.note}

[_Not once did I fully grasp the concept_]{.fragment}
:::

---

. . .

::: {.vertical-center}
> When I decided to learn ~~CG~~ ~~statistics~~, I read several ~~descriptions~~ books which I shall politely not identify. I understood none of them. Most of them simply ~~wrote down the method~~ described statistical procedures, then applied them without any intuitive explanation or hint of how anyone might have invented these procedures in the first place. This ~~article~~ ~~talk~~ slide was born of that frustration and my wish that future student will learn the deep and elegant ideas at the heart of statistics rather than the confusing grab bag of statistical procedures.^[From John Rauser's talk at Strata in 2014 [(click here)](https://youtu.be/5Dnw46eC-0o)]
:::


---

::: {.vertical-center}
In every stats class I have ever taken, I learned about [hypothesis testing]{.note}

<br>

[_I never fully grasped it until I learned to program_]{.fragment}
:::

---

::: {.vertical-center}
_If you can program, you have direct access to the fundamental ideas in statistics_

[To demonstrate, consider [hypothesis testing]{.note}]{.fragment}

[_In order to do that, we need a probelm..._]{.fragment}

[_Does drinking beer make you more attractive to mosquitos?]{.fragment}

:::

---

## Hypothesis testing

Though it sounds silly, this research question is important

- Malaria is transmitted via mosquito
- Most model for malaria transmission historically assume equal risk of mosquito bites across individuals
- Though, good evidence of _heterogenous_ propensity bites exist
- Understanding which people might have higher propensity for bites may allow for interventions that reduce the impact of malaria

---

![](./image/Screenshot%202023-03-23%20at%203.42.08%20PM.png)

---

## Experiment data

```{r}
#| echo: FALSE

beer = c(27, 20, 21, 26, 27, 31, 24, 21, 20, 19, 23, 24, 28, 19, 24, 29, 18, 20, 17, 31, 20, 25, 28, 21, 27)

beer = tibble(
  count = beer,
  group = "beer",
  row = rep(1:5, times = 5),
  # row = expand.grid()
  col = rep(1:5, each = 5)
)

water = c(21, 22, 15, 12, 21, 16, 19, 15, 22, 24, 19, 23, 13, 22, 20, 24, 18, 20)

water = tibble(
  count = water,
  group = "water",
  row = rep(1:3, times = 6),
  col = rep(1:6, each = 3)
)

tib = rbind(beer, water)

tib %<>% mutate(
  s1 = sample_n(size = size)
)

mu0 = tib |>
  group_by(group) |>
  summarize(mean = mean(count) |> round(2))

```

```{r}
#| fig.height: 5

set.seed(48)

leg_cols <- c(" " = "black", " " = "green")


dat = ggplot(tib, aes(x = row, y = col), group = group, color = group) +
  # geom_point(shape = 15, size = 30) +
  geom_label(
    aes(
      label = count
      , vjust = 0.5
      , hjust = 0.5
      , color = 'white'
      , fill = group
      , group = group
      ),
    , color = 'white'
    , size = 6
    , label.size = 1
    , label.padding	= unit(.9, "lines")
    , position = position_nudge(x = -0.5, y = -0.2)
      ) +
  scale_x_continuous(limits = c(-0.5, 5)) +
  theme_void() +
  theme(
    legend.position = "bottom"
    , panel.spacing = unit(5, "cm")
    , strip.text = element_blank()
    , title = element_text(family = "Fira Sans")
    , plot.margin = margin(t = 30, r = 5, b = 5, l = 5, unit = "pt")
  ) +
  coord_cartesian(clip = 'off') +
  facet_wrap(~group) +
  scale_fill_manual(values = c(hii, "grey50"), guide = "none")

```

```{r}
#| echo: FALSE
#| fig.height: 5
dat
```

---

## Experiment data {data-visibility="uncounted"}

```{r}
#| fig.height: 5

library(grid)

dat 

grid.text(
  paste0("Mean (beer) = ", mu0[1,2], "\n",
         "Mean (water) = ", mu0[2,2], "\n",
          "Difference (beer - water) = ", mu0[1,2] - mu0[2,2]
        ),
  x = unit(0.2, "npc"), y = unit(1, "npc") - unit(60, "pt"), just = "bottom", gp = gpar(fontsize = 10, fontfamily = "Fira Sans"))


# + annotate("text", x = 1.5, y = 4.5, label = paste0("Mean (beer) = ", mu0[1,2], "\n",
#                      "Mean (water) = ", mu0[2,2], "\n",
#                      "Difference (beer - water) = ", mu0[1,2] - mu0[2,2]), size = 5, fontface = "bold", hjust = 0)

# labs(
#     subtitle = paste0("Mean (beer) = ", mu0[1,2], "\n",
#                      "Mean (water) = ", mu0[2,2], "\n",
#                      "Difference (beer - water) = ", mu0[1,2] - mu0[2,2])
# #   )
```